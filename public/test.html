<!DOCTYPE html>
<html>
<body>
    <input type="file" id="cvFile">
    <button onclick="uploadTest()">Tester Upload v2</button>
    
    <script>
        const R2_CONFIG = {
            accountId: '298ee83d49284d7cc8b8c2eac280bf44',
            bucketName: 'ae2i-cvs-algerie',
            accessToken: 'V384UWFH_NGjQDJyOn37zYLVg1dtX1DeyyRttI79' // Remplace par ton token
        };

        async function uploadTest() {
            const fileInput = document.getElementById('cvFile');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('Choisis un fichier!');
                return;
            }
            
            // Nom plus simple
            const fileName = `test-upload.pdf`;
            const uploadUrl = `https://${R2_CONFIG.accountId}.r2.cloudflarestorage.com/${R2_CONFIG.bucketName}/${fileName}`;
            
            console.log('URL:', uploadUrl);
            console.log('Token:', R2_CONFIG.accessToken.substring(0, 20) + '...');
            
            try {
                // Version simplifiée
                const response = await fetch(uploadUrl, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${R2_CONFIG.accessToken}`,
                        'Content-Type': 'application/pdf'
                    },
                    body: file
                });
                
                console.log('Status:', response.status);
                console.log('Headers:', response.headers);
                
                if (response.ok) {
                    alert('✅ Upload réussi! Code: ' + response.status);
                } else {
                    const errorText = await response.text();
                    alert('❌ Erreur ' + response.status + ': ' + errorText);
                }
            } catch (error) {
                console.error('Full error:', error);
                alert('❌ Erreur fetch: ' + error.message);
            }
        }
    </script>
</body>
</html>